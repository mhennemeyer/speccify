<h1 id="speccify">Speccify</h1>

<h2 id="alightweightalternativetorspec.">A lightweight alternative to RSpec.</h2>

<h2 id="features:">Features:</h2>

<ul>
<li><strong>Blazing Fast</strong></li>
<li><strong>100% Ruby 1.9 compatible</strong></li>
<li><strong>Rails!</strong></li>
<li><strong>Nested Contexts</strong></li>
<li><strong>Sophisticated Expectations/Matchers System</strong></li>
<li><strong>Based on MiniTest</strong></li>
<li><strong>&lt; 300 LOC</strong></li>
</ul>

<h2 id="installspeccify:">Install Speccify:</h2>

<blockquote>
  <p>sudo gem install speccify</p>
</blockquote>

<h2 id="usingspeccifyplain">Using Speccify (Plain)</h2>

<p>Create a testfile like test_object.rb:</p>

<pre><code>        # test_object.rb  

        require "rubygems"  
        require "speccify"  

        describe Object do  
          before do  
            @obj = Object.new  
          end 

          it "is not nil" do
            @obj.should_not be_nil
          end

          it "can be frozen" do
            @obj.freeze
            @obj.should be_frozen
          end
        end
</code></pre>

<p>Run it with the ruby command:</p>

<blockquote>
  <p>$ ruby test_object.rb <br />
  Loaded suite - <br />
  Started <br />
  .. <br />
  Finished in 0.001820 seconds.  </p>
  
  <p>2 tests, 2 assertions, 0 failures, 0 errors, 0 skips  </p>
</blockquote>

<h2 id="usingspeccifywithautotest">Using Speccify with autotest</h2>

<ol>
<li>Name your testfiles test_whatever.rb</li>
<li>$ autotest</li>
<li>No step three ..</li>
</ol>

<h2 id="usingspeccifywithrails">Using Speccify with Rails</h2>

<p>Use the default rails test directory/structure, testhelpers, assertions and infrastructure.</p>

<ol>
<li>sudo use_minitest yes todo: link</li>
<li>require &#8216;speccify&#8217; in test_helper.rb</li>
<li>No step three</li>
</ol>

<h2 id="builtinmatchers">Built in matchers</h2>

<ul>
<li><p>be_something, for any arbitrary something:  </p>

<pre><code>@obj.should be_something
# passes if @obj.something? is true
</code></pre></li>
<li><p>have(n).somethings, for any arbitrary something:</p>

<pre><code>@obj.should have(3).somethings
# passes if @obj.somethings.length == 3
</code></pre></li>
<li><p>change {something}</p>

<pre><code>lambda {@var+=1}.should change {@var}
# passes
lambda { }.should change {@var}
# fails
@var = 1
lambda {@var+=1}.should change {@var}.from(1).to(2)
# passes
</code></pre></li>
</ul>

<h2 id="def_matcher">DEF_MATCHER</h2>

<ul>
<li><p>A simple example:  </p>

<pre><code>def_matcher :be_nil do |given, matcher, args|
  given.nil?
end
nil.should be_nil
</code></pre></li>
<li><p>A little more complex:</p>

<pre><code>    def_matcher :be_in_range do |given, matcher, args|
      range = args[1] ? (args[0]..args[1]) : args[0]
      matcher.positive_msg = "expected #{given} to be in range (#{range})"
      matcher.negative_msg = "expected #{given} not to be in range (#{range})"
      range.include?(given)
    end
    2.should be_in_range(1,3)
    "m".should be_in_range("a".."z")
</code></pre></li>
<li><p>Matchers may receive messages:</p>

<pre><code>    def_matcher :have do |given, matcher, args|
      number = args[0]
      actual = given.send(matcher.msgs[0].name).length
      matcher.positive_msg = "Expected #{given} to have #{actual}, but found #{number} "
      actual == number
    end
    class Thing
      def widgets
        @widgets ||= []
      end
    end
    @thing.should have(3).widgets
</code></pre></li>
</ul>

<h2 id="speccifyvs.rspec">Speccify vs. RSpec</h2>

<p><strong>Speccify provides the part of RSpec that actually matters (to me):</strong></p>

<ul>
<li><strong>The familiar describe/it syntax</strong></li>
<li><strong>nested contexts</strong></li>
<li><strong>should/should_not</strong></li>
<li><strong>matchers and custom matchers</strong></li>
</ul>

<p><strong>Things that actually doesn&#8217;t matter (to me):</strong></p>

<ul>
<li><strong>/spec directory instead of /test</strong></li>
<li><strong><code>whatever_spec.rb instead of test_whatever.rb</code></strong></li>
<li><strong>custom formatters</strong></li>
<li><strong>custom runners</strong></li>
<li><strong>html output</strong></li>
<li><strong>special commandline tools</strong></li>
<li><strong>shared example groups</strong></li>
<li><strong>pending examples</strong></li>
</ul>

<h2 id="problems">Problems</h2>

<p>If using speccify with <code>minitest_tu_shim</code> and rails,
mocha-0.9.4 causes errors because of minitest compatibility.
This issue is fixed in mocha&#8217;s trunk and won&#8217;t be in 0.9.5</p>
